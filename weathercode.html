<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://cdn.glitch.global/af09a4d4-4ea4-4fcd-81e5-3d1dc94c9b66/thumbnails%2FSchoolGS%20Logo%20(5).png?1735577111603">
    <title>Weather App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to top, black, #020121, #020121, black);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background 0.5s ease;
        }

        .container {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0);
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0);
            width: 100%;
            max-width: 400px;
        }

        h1 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .notification {
            background: #f44336;
            color: white;
            padding: 10px;
            margin-top: 20px;
            border-radius: 4px;
            display: none;
        }

        .chart-container {
            width: 100%;
            margin-top: 20px;
        }

        canvas {
            width: 100% !important;
            max-width: 100%;
            height: 300px;
        }

        .tooltip {
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            display: none;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }

            canvas {
                height: 200px;
            }
        }
    </style>

    <!-- Chart.js for Graph -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="container">

        <div class="notification" id="notification"></div>

        <!-- Temperature Chart -->
        <div class="chart-container">
            <canvas id="temp-chart"></canvas>
        </div>

        <!-- Precipitation Chart -->
        <div class="chart-container">
            <canvas id="precipitation-chart"></canvas>
        </div>

        <!-- Snowfall Chart -->
        <div class="chart-container">
            <canvas id="snowfall-chart"></canvas>
        </div>

        <!-- Wind Speed Chart -->
        <div class="chart-container">
            <canvas id="wind-speed-chart"></canvas>
        </div>
    </div>

    <script>
        let currentTemperature = null;

        window.onload = function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    updateWeather(latitude, longitude);
                    setInterval(() => updateWeather(latitude, longitude), 60000); // Update every minute
                }, function(error) {
                    displayNotification("Failed to retrieve location.", "error");
                });
            } else {
                displayNotification("Geolocation is not supported by this browser.", "error");
            }
        };

        async function updateWeather(lat, lon) {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,precipitation,snowfall,windspeed_10m&timezone=Europe%2FBerlin`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (data.error) {
                    displayNotification("Error fetching weather data. Please check the coordinates.", "error");
                } else {
                    currentTemperature = data.hourly.temperature_2m[0];
                    updateTitle();
                    displayTemperatureChart(data);
                    displayPrecipitationChart(data);
                    displaySnowfallChart(data);  // Added snowfall chart
                    displayWindSpeedChart(data); // Restored wind speed chart
                }
            } catch (error) {
                displayNotification("Error fetching weather data.", "error");
            }
        }

        function updateTitle() {
            const titleElement = document.getElementById('title');
        }

        function displayNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.backgroundColor = type === "error" ? "#f44336" : "#4CAF50"; // Red for error, green for success
            notification.style.display = "block";
            setTimeout(() => notification.style.display = "none", 5000); // Hide after 5 seconds
        }

        function displayTemperatureChart(data) {
            const currentTime = new Date();
            const currentHour = currentTime.getHours();
            const next24Hours = data.hourly.time.slice(currentHour, currentHour + 24);
            const temperatures = data.hourly.temperature_2m.slice(currentHour, currentHour + 24);
            const times = next24Hours.map(time => {
                const date = new Date(time);
                return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
            });

            const ctx = document.getElementById('temp-chart').getContext('2d');
            const tempChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: times,
                    datasets: [{
                        label: `Temperature (°C) - ${currentTemperature}°C`,
                        data: temperatures,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.2)',
                                tickMarkLength: 0
                            },
                            ticks: {
                                autoSkip: false,
                                maxRotation: 90,
                                minRotation: 90,
                                font: {
                                    size: 10,
                                    family: 'Arial, sans-serif',
                                }
                            }
                        },
                        y: {
                            max: 30,
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.075)',
                                lineWidth: 1
                            },
                            ticks: {
                                stepSize: 5,
                            }
                        }
                    }
                }
            });
        }

        function displayPrecipitationChart(data) {
            const currentTime = new Date();
            const currentHour = currentTime.getHours();
            const next24Hours = data.hourly.time.slice(currentHour, currentHour + 24);
            const precipitation = data.hourly.precipitation.slice(currentHour, currentHour + 24);
            const times = next24Hours.map(time => {
                const date = new Date(time);
                return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
            });

            const ctx = document.getElementById('precipitation-chart').getContext('2d');
            const precipitationChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: times,
                    datasets: [{
                        label: 'Precipitation (mm)',
                        data: precipitation,
                        borderColor: '#403bcc',
                        backgroundColor: '#403bcc',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { 
                            max: 10,
                            min: 0,
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.075)', 
                                lineWidth: 1
                            },
                        },
                        x: {
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.2)',
                                tickMarkLength: 0
                            },
                            ticks: {
                                autoSkip: false,
                                maxRotation: 90,
                                minRotation: 90,
                                font: {
                                    size: 10, 
                                    family: 'Arial, sans-serif',
                                }
                            }
                        }
                    }
                }
            });
        }

        function displaySnowfallChart(data) {
            const currentTime = new Date();
            const currentHour = currentTime.getHours();
            const next24Hours = data.hourly.time.slice(currentHour, currentHour + 24);
            const snowfall = data.hourly.snowfall.slice(currentHour, currentHour + 24);
            const times = next24Hours.map(time => {
                const date = new Date(time);
                return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
            });

            const ctx = document.getElementById('snowfall-chart').getContext('2d');
            const snowfallChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: times,
                    datasets: [{
                        label: 'Snowfall (mm)',
                        data: snowfall,
                        borderColor: '#fff',
                        backgroundColor: '#00bfff',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { 
                            max: 10,
                            min: 0,
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.075)', 
                                lineWidth: 1
                            },
                        },
                        x: {
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.2)',
                                tickMarkLength: 0
                            },
                            ticks: {
                                autoSkip: false,
                                maxRotation: 90,
                                minRotation: 90,
                                font: {
                                    size: 10, 
                                    family: 'Arial, sans-serif',
                                }
                            }
                        }
                    }
                }
            });
        }

        function displayWindSpeedChart(data) {
            const currentTime = new Date();
            const currentHour = currentTime.getHours();
            const next24Hours = data.hourly.time.slice(currentHour, currentHour + 24);
            const windSpeedsAt10m = data.hourly.windspeed_10m.slice(currentHour, currentHour + 24);

            const times = next24Hours.map(time => {
                const date = new Date(time);
                return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
            });

            const ctx = document.getElementById('wind-speed-chart').getContext('2d');
            const windSpeedChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: times,
                    datasets: [{
                        label: 'Wind Speed (m/s)',
                        data: windSpeedsAt10m,
                        borderColor: '#00bfff',
                        backgroundColor: 'rgba(0, 191, 255, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.2)',
                                tickMarkLength: 0
                            },
                            ticks: {
                                autoSkip: false,
                                maxRotation: 90,
                                minRotation: 90,
                                font: {
                                    size: 10,
                                    family: 'Arial, sans-serif',
                                }
                            }
                        },
                        y: {
                            max: 15,
                            grid: {
                                display: true,
                                color: 'rgba(255, 255, 255, 0.075)',
                                lineWidth: 1
                            },
                            ticks: {
                                stepSize: 3,
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
